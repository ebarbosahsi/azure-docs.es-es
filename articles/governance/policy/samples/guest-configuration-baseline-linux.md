---
title: 'Referencia: línea base de Configuración de invitado de Azure Policy para Linux'
description: Detalles de la línea base de Linux en Azure implementada a través de la Configuración de invitado de Azure Policy.
ms.date: 03/12/2021
ms.topic: reference
ms.custom: generated
ms.openlocfilehash: 6b1d3048fdc0945e1ee64e211d2f7b1f9de5e6e6
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 03/20/2021
ms.locfileid: "103419871"
---
# <a name="azure-policy-guest-configuration-baseline-for-linux"></a>Línea base de Configuración de invitado de Azure Policy para Linux

En el artículo siguiente se detallan las auditorías de definición de directiva de Configuración de usuario **\[Versión preliminar\] Las máquinas Linux deben cumplir los requisitos de la línea de base de seguridad de Azure**. Para obtener más información, vea [Configuración de invitado de Azure Policy](../concepts/guest-configuration.md) e [Información general sobre Azure Security Benchmark (V2)](../../../security/benchmarks/overview.md).

## <a name="general-security-controls"></a>Controles de seguridad generales

|Nombre<br /><sub>(ID)</sub> |Detalles |Comprobación de corrección |
|---|---|---|
|Asegurarse de que la opción nodev está establecida en la partición /home.<br /><sub>(1.1.4)</sub> |Descripción: un atacante podría montar un dispositivo especial (por ejemplo, un dispositivo de bloque o de caracteres) en la partición /home. |Edite el archivo /etc/fstab y agregue nodev al cuarto campo (opciones de montaje) para la partición /home. Para obtener más información, vea las páginas del manual fstab(5). |
|Asegurarse de que la opción nodev está establecida en la partición /tmp.<br /><sub>(1.1.5)</sub> |Descripción: un atacante podría montar un dispositivo especial (por ejemplo, un dispositivo de bloque o de caracteres) en la partición /tmp. |Edite el archivo /etc/fstab y agregue nodev al cuarto campo (opciones de montaje) para la partición /tmp. Para obtener más información, vea las páginas del manual fstab(5). |
|Asegurarse de que la opción nodev está establecida en la partición /var/tmp.<br /><sub>(1.1.6)</sub> |Descripción: un atacante podría montar un dispositivo especial (por ejemplo, un dispositivo de bloque o de caracteres) en la partición /var/tmp. |Edite el archivo /etc/fstab y agregue nodev al cuarto campo (opciones de montaje) para la partición /var/tmp. Para obtener más información, vea las páginas del manual fstab(5). |
|Asegurarse de que la opción nosuid está establecida en la partición /tmp.<br /><sub>(1.1.7)</sub> |Descripción: dado que el sistema de archivos /tmp solo está pensado para el almacenamiento temporal de archivos, establezca esta opción para asegurarse de que los usuarios no puedan crear archivos setuid en /var/tmp. |Edite el archivo /etc/fstab y agregue nosuid al cuarto campo (opciones de montaje) para la partición /tmp. Para obtener más información, vea las páginas del manual fstab(5). |
|Asegurarse de que la opción nosuid está establecida en la partición /var/tmp.<br /><sub>(1.1.8)</sub> |Descripción: dado que el sistema de archivos /var/tmp solo está pensado para el almacenamiento temporal de archivos, establezca esta opción para asegurarse de que los usuarios no puedan crear archivos setuid en /var/tmp. |Edite el archivo /etc/fstab y agregue nosuid al cuarto campo (opciones de montaje) para la partición /var/tmp. Para obtener más información, vea las páginas del manual fstab(5). |
|Asegurarse de que la opción noexec está establecida en la partición /var/tmp.<br /><sub>(1.1.9)</sub> |Descripción: dado que el sistema de archivos `/var/tmp` solo está pensado para el almacenamiento temporal de archivos, establezca esta opción para asegurarse de que los usuarios no puedan ejecutar archivos binarios ejecutables desde `/var/tmp`. |Edite el archivo /etc/fstab y agregue noexec al cuarto campo (opciones de montaje) para la partición /var/tmp. Para obtener más información, vea las páginas del manual fstab(5). |
|Asegurarse de que la opción noexec está establecida en la partición /dev/shm.<br /><sub>(1.1.16)</sub> |Descripción: la configuración de esta opción en un sistema de archivos impide que los usuarios ejecuten programas desde la memoria compartida. Esto impide que los usuarios introduzcan software potencialmente malintencionado en el sistema. |Edite el archivo /etc/fstab y agregue noexec al cuarto campo (opciones de montaje) para la partición /dev/shm. Para obtener más información, vea las páginas del manual fstab(5). |
|Deshabilitar el montaje automático.<br /><sub>(1.1.21)</sub> |Descripción: con el montaje automático habilitado, cualquier persona con acceso físico podría conectar una unidad USB o un disco, y tener su contenido disponible en el sistema, incluso si faltan permisos para montarlos. |Deshabilite el servicio autofs o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-autofs". |
|Asegurarse de que el montaje de dispositivos de almacenamiento USB está deshabilitado.<br /><sub>(1.1.21.1)</sub> |Descripción: la eliminación de la compatibilidad con dispositivos de almacenamiento USB reduce la superficie de ataque local del servidor. |Edite o cree un archivo en el directorio `/etc/modprobe.d/` que termine en .conf y agregue `install usb-storage /bin/true`; después, descargue el módulo usb-storage o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods". |
|Asegurarse de que los volcados principales están restringidos.<br /><sub>(1.5.1)</sub> |Descripción: la configuración de un límite máximo en los volcados principales impide que los usuarios invaliden la variable de software. Si se requieren volcados principales, considere la posibilidad de establecer límites para los grupos de usuarios (vea `limits.conf(5)`). Además, si se establece la variable `fs.suid_dumpable` en 0, impedirá que los programas setuid realicen un volcado principal. |Agregue `hard core 0` a /etc/security/limits.conf. o a un archivo en el directorio limits.d y establezca `fs.suid_dumpable = 0` en sysctl o ejecute "opt/microsoft/omsagent/plugin/omsremediate -r disable-core-dumps". |
|Asegurarse de que la vinculación previa está deshabilitada.<br /><sub>(1.5.4)</sub> |Descripción: la característica de vinculación previa puede interferir con el funcionamiento de AIDE, ya que cambia los archivos binarios. La vinculación previa también puede aumentar la vulnerabilidad del sistema en caso de que un usuario malintencionado sepa poner en peligro una biblioteca común, como libc. |Desinstale `prelink` con el administrador de paquetes o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r remove-prelink". |
|Asegurarse de que los permisos en /etc/motd están configurados.<br /><sub>(1.7.1.4)</sub> |Descripción: si el archivo `/etc/motd` no tiene la propiedad correcta, lo podrían modificar usuarios no autorizados con información incorrecta o engañosa. |Establezca el propietario y el grupo de /etc/motd en raíz, y establezca los permisos en 0644 o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r file-permissions". |
|Asegurarse de que están configurados los permisos en /etc/issue.<br /><sub>(1.7.1.5)</sub> |Descripción: si el archivo `/etc/issue` no tiene la propiedad correcta, lo podrían modificar usuarios no autorizados con información incorrecta o engañosa. |Establezca el propietario y el grupo de /etc/issue en raíz, y establezca los permisos en 0644 o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r file-permissions". |
|Asegurarse de que están configurados los permisos en /etc/issue.net.<br /><sub>(1.7.1.6)</sub> |Descripción: si el archivo `/etc/issue.net` no tiene la propiedad correcta, lo podrían modificar usuarios no autorizados con información incorrecta o engañosa. |Establezca el propietario y el grupo de /etc/issue.net en raíz, y establezca los permisos en 0644 o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r file-permissions". |
|La opción nodev debe estar habilitada para todos los medios extraíbles.<br /><sub>2.1</sub> |Descripción: un atacante podría montar un dispositivo especial (por ejemplo, un dispositivo de bloque o de caracteres) a través de medios extraíbles. |Agregue la opción nodev al cuarto campo (opciones de montaje) en /etc/fstab. |
|La opción noexec debe estar habilitada para todos los medios extraíbles.<br /><sub>2.2</sub> |Descripción: un atacante podría cargar el archivo ejecutable a través de medios extraíbles. |Agregue la opción noexec al cuarto campo (opciones de montaje) en /etc/fstab. |
|La opción nosuid debe estar habilitada para todos los medios extraíbles.<br /><sub>2.3</sub> |Descripción: un atacante podría cargar archivos que se ejecutan con un contexto de seguridad elevado a través de medios extraíbles. |Agregue la opción nosuid al cuarto campo (opciones de montaje) en /etc/fstab. |
|Asegurarse de que el cliente talk no está instalado.<br /><sub>(2.3.3)</sub> |Descripción: el software presenta un riesgo de seguridad, ya que utiliza protocolos no cifrados para la comunicación. |Desinstale `talk` o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r remove-talk". |
|Asegurarse de que están configurados los permisos en /etc/hosts.allow.<br /><sub>(3.4.4)</sub> |Descripción: es fundamental asegurarse de que el archivo `/etc/hosts.allow` está protegido contra el acceso de escritura no autorizado. Aunque está protegido de manera predeterminada, los permisos de archivo se pueden cambiar de forma involuntaria o a través de acciones malintencionadas. |Establezca el propietario y el grupo de /etc/hosts.allow en raíz, y los permisos en 0644, o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r file-permissions". |
|Asegurarse de que están configurados los permisos en /etc/hosts.deny.<br /><sub>(3.4.5)</sub> |Descripción: es fundamental asegurarse de que el archivo `/etc/hosts.deny` está protegido contra el acceso de escritura no autorizado. Aunque está protegido de manera predeterminada, los permisos de archivo se pueden cambiar de forma involuntaria o a través de acciones malintencionadas. |Establezca el propietario y el grupo de /etc/hosts.deny en raíz, y los permisos en 0644, o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r file-permissions". |
|Garantizar la directiva de firewall de denegación predeterminada.<br /><sub>(3.6.2)</sub> |Descripción: con una directiva de aceptación predeterminada, el firewall aceptará cualquier paquete que no esté configurado para denegarse. Es más fácil mantener un firewall seguro con una directiva de ELIMINACIÓN predeterminada que con una directiva de PERMISO predeterminada. |Establezca la directiva predeterminada para el tráfico de entrada, de salida y enrutado en `deny` o `reject`, según corresponda con el software de firewall. |
|La opción nodev/nosuid debe estar habilitada para todos los montajes NFS.<br /><sub>(5)</sub> |Descripción: un atacante podría cargar archivos que se ejecutan con un contexto de seguridad elevado o dispositivos especiales a través del sistema de archivos remoto. |Agregue las opciones nosuid y nodev al cuarto campo (opciones de montaje) en /etc/fstab. |
|Asegurarse de que están configurados los requisitos para la creación de contraseñas.<br /><sub>(5.3.1)</sub> |Descripción: las contraseñas seguras protegen los sistemas frente a ataques mediante métodos de fuerza bruta. |Establezca los siguientes pares clave-valor en la PAM adecuada para su distribución: minlen = 14, minclass = 4, dcredit = -1, ucredit = -1, ocredit = -1, lcredit = -1, o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r enable-password-requirements". |
|Asegurarse de que se ha configurado el bloqueo de intentos de contraseña erróneos.<br /><sub>(5.3.2)</sub> |Descripción: al bloquear los Id. de usuario después de `n` intentos incorrectos consecutivos de inicio de sesión, se mitigan los ataques por fuerza bruta de contraseñas en los sistemas. |En el caso de Ubuntu y Debian, agregue los módulos pam_tally y pam_deny, según corresponda. Para el resto de distribuciones, consulte la documentación de su distribución. |
|Deshabilitar la instalación y el uso de sistemas de archivos que no son necesarios (cramfs).<br /><sub>6.1</sub> |Descripción: un atacante podría usar una vulnerabilidad en cramfs para elevar los privilegios. |Agregue un archivo al directorio /etc/modprob.d que deshabilite cramfs o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods". |
|Deshabilitar la instalación y el uso de sistemas de archivos que no son necesarios (freevxfs).<br /><sub>6.2</sub> |Descripción: un atacante podría usar una vulnerabilidad en freevxfs para elevar los privilegios. |Agregue un archivo al directorio /etc/modprob.d que deshabilite freevxfs o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods". |
|Asegurarse de que existen todos los directorios principales de los usuarios.<br /><sub>(6.2.7)</sub> |Descripción: si el directorio principal del usuario no existe o no está asignado, el usuario se colocará en "/" y no podrá escribir ningún archivo ni tener establecidas variables de entorno locales. |Si los directorios principales de los usuarios no existen, créelos y asegúrese de que el usuario correspondiente es el propietario del directorio. Los usuarios sin un directorio particular asignado deben quitarse o asignarse a un directorio particular, según corresponda. |
|Asegurarse de que los usuarios son propietarios de sus directorios principales.<br /><sub>(6.2.9)</sub> |Descripción: dado que el usuario es responsable de los archivos almacenados en el directorio principal del usuario, debe ser el propietario del directorio. |Cambie la propiedad de los directorios particulares que no son propiedad del usuario definido al usuario correcto. |
|Asegurarse de que los archivos que comienzan por punto de los usuarios no son de grupo ni de escritura internacional.<br /><sub>(6.2.10)</sub> |Descripción: los archivos de configuración de usuario de grupo o de escritura internacional pueden permitir que los usuarios malintencionados roben o modifiquen los datos de otros usuarios, o que tengan privilegios de sistema de otro usuario. |Realizar modificaciones globales en los archivos de los usuarios sin avisar a la comunidad de usuarios puede provocar interrupciones inesperadas y usuarios insatisfechos. Por lo tanto, se recomienda establecer una directiva de supervisión para informar de los permisos de archivo que comienza por punto de usuario y determinar la acción que se realizará de acuerdo con la directiva de sitio. |
|Asegurarse de que ningún usuario tiene archivos .forward.<br /><sub>(6.2.11)</sub> |Descripción: el uso del archivo `.forward` supone un riesgo de seguridad, puesto que los datos confidenciales se pueden transferir accidentalmente fuera de la organización. El archivo `.forward` también supone un riesgo, ya que se puede usar para ejecutar comandos que pueden realizar acciones no intencionadas. |Realizar modificaciones globales en los archivos de los usuarios sin avisar a la comunidad de usuarios puede provocar interrupciones inesperadas y usuarios insatisfechos. Por lo tanto, se recomienda establecer una directiva de supervisión para informar de los archivos `.forward` de los usuarios y determinar la acción que se realizará de acuerdo con la directiva de sitio. |
|Asegurarse de que ningún usuario tiene archivos .netrc.<br /><sub>(6.2.12)</sub> |Descripción: el archivo `.netrc` presenta un riesgo de seguridad importante, ya que almacena las contraseñas en formato no cifrado. Incluso si el FTP está deshabilitado, las cuentas de usuario pueden haber trasladado archivos `.netrc` de otros sistemas que podrían suponer un riesgo para esos sistemas. |Realizar modificaciones globales en los archivos de los usuarios sin avisar a la comunidad de usuarios puede provocar interrupciones inesperadas y usuarios insatisfechos. Por lo tanto, se recomienda establecer una directiva de supervisión para informar de los archivos `.netrc` de los usuarios y determinar la acción que se realizará de acuerdo con la directiva de sitio. |
|Asegurarse de que ningún usuario tiene archivos .rhosts.<br /><sub>(6.2.14)</sub> |Descripción: esta acción solo es significativa si se permite la compatibilidad de `.rhosts` en el archivo `/etc/pam.conf`. Aunque los archivos `.rhosts` no son eficaces si la compatibilidad está deshabilitada en `/etc/pam.conf`, es posible que se hayan trasladado desde otros sistemas y que contengan información útil para un atacante para esos otros sistemas. |Realizar modificaciones globales en los archivos de los usuarios sin avisar a la comunidad de usuarios puede provocar interrupciones inesperadas y usuarios insatisfechos. Por lo tanto, se recomienda establecer una directiva de supervisión para informar al usuario de los archivos `.rhosts` y determinar la acción que se realizará de acuerdo con la directiva de sitio. |
|Asegurarse de que todos los grupos en /etc/passwd existen en /etc/group.<br /><sub>(6.2.15)</sub> |Descripción: los grupos que se definen en el archivo /etc/passwd, pero no en /etc/group, suponen una amenaza para la seguridad del sistema, ya que los permisos de grupo no se administran correctamente. |Para cada grupo definido en/etc/passwd, asegúrese de que haya un grupo correspondiente en /etc/group. |
|Asegurarse de que no existen UID duplicados.<br /><sub>(6.2.16)</sub> |Descripción: los usuarios deben tener asignados UID únicos para la responsabilidad y a fin de garantizar las protecciones de acceso adecuadas. |Establezca UID únicos y revise todos los archivos que pertenecen a los UID compartidos para determinar a cuál deben pertenecer. |
|Asegurarse de que no existe ningún GID duplicado.<br /><sub>(6.2.17)</sub> |Descripción: los grupos deben tener asignado GID únicos para la responsabilidad y a fin de garantizar las protecciones de acceso adecuadas. |Establezca GID únicos y revise todos los archivos que pertenecen a los GID compartidos para determinar a cuál deben pertenecer. |
|Asegurarse de que no existe ningún nombre de usuario duplicado.<br /><sub>(6.2.18)</sub> |Descripción: si se asigna un nombre de usuario duplicado a un usuario, se creará y tendrá acceso a los archivos con el primer UID de ese nombre de usuario en `/etc/passwd`. Por ejemplo, si "test4" tiene un UID de 1000 y una entrada posterior de "test4" tiene un UID de 2000, el inicio de sesión como "test4" usará el UID 1000. De hecho, el UID es compartido, lo que supone un problema de seguridad. |Establezca nombres de usuario únicos para los usuarios. La propiedad de los archivos reflejará automáticamente el cambio siempre y cuando los usuarios tengan UID únicos. |
|Asegurarse de que no existen grupos duplicados.<br /><sub>(6.2.19)</sub> |Descripción: si se asigna un nombre de grupo duplicado a un grupo, se creará y tendrá acceso a los archivos con el primer UID de ese grupo en `/etc/group`. De hecho, el GID es compartido, lo que supone un problema de seguridad. |Establezca nombres únicos para los grupos de usuarios. La propiedad de los grupos de archivos reflejará automáticamente el cambio siempre que los grupos tengan GID únicos. |
|Asegurarse de que el grupo de instantáneas está vacío.<br /><sub>(6.2.20)</sub> |Descripción: a todos los usuarios asignados al grupo de instantáneas se les concedería acceso de lectura al archivo /etc/shadow. Si los atacantes pueden obtener acceso de lectura al archivo `/etc/shadow`, podrán ejecutar fácilmente un programa de averiguación de contraseñas en las contraseñas con hash para interrumpirlas. Otra información de seguridad que se almacena en el archivo`/etc/shadow` (por ejemplo, la expiración) también podría ser útil para debilitar las cuentas de usuario adicionales. |Quite a todos los usuarios del grupo de instantáneas. |
|Deshabilitar la instalación y el uso de sistemas de archivos que no son necesarios (hfs).<br /><sub>6.3</sub> |Descripción: un atacante podría usar una vulnerabilidad en hfs para elevar los privilegios. |Agregue un archivo al directorio /etc/modprob.d que deshabilite hfs o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods". |
|Deshabilitar la instalación y el uso de sistemas de archivos que no son necesarios (hfsplus).<br /><sub>6.4</sub> |Descripción: un atacante podría usar una vulnerabilidad en hfsplus para elevar los privilegios. |Agregue un archivo al directorio /etc/modprob.d que deshabilite hfsplus o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods". |
|Deshabilitar la instalación y el uso de sistemas de archivos que no son necesarios (jffs2).<br /><sub>6.5</sub> |Descripción: un atacante podría usar una vulnerabilidad en jffs2 para elevar los privilegios. |Agregue un archivo al directorio /etc/modprob.d que deshabilite jffs2 o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods". |
|Los kernels solo deben compilarse desde orígenes aprobados.<br /><sub>(10)</sub> |Descripción: un kernel de un origen no aprobado podría contener vulnerabilidades o puertas traseras para conceder acceso a un atacante. |Instale el kernel que ha proporcionado el proveedor de distribución. |
|Los permisos de archivo /etc/shadow deben establecerse en 0400.<br /><sub>(11.1)</sub> |Descripción: un atacante que puede recuperar o manipular contraseñas con hash de /etc/shadow si no está protegido correctamente. |Establezca los permisos y la propiedad de /etc/shadow* o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r set-etc-shadow-perms". |
|Los permisos de archivo /etc/shadow- deben establecerse en 0400.<br /><sub>(11.2)</sub> |Descripción: un atacante que puede recuperar o manipular contraseñas con hash de /etc/shadow- si no está protegido correctamente. |Establezca los permisos y la propiedad de /etc/shadow* o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r set-etc-shadow-perms". |
|Los permisos de archivo /etc/gshadow deben establecerse en 0400.<br /><sub>(11.3)</sub> |Descripción: un atacante podría unirse a grupos de seguridad si este archivo no está protegido correctamente. |Establezca los permisos y la propiedad de/etc/gshadow- o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r set-etc-gshadow-perms" |
|Los permisos de archivo/etc/gshadow- deben establecerse en 0400.<br /><sub>(11.4)</sub> |Descripción: un atacante podría unirse a grupos de seguridad si este archivo no está protegido correctamente. |Establezca los permisos y la propiedad de/etc/gshadow o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r set-etc-gshadow-perms". |
|Los permisos de archivo /etc/passwd deben establecerse en 0644.<br /><sub>(12.1)</sub> |Descripción: un atacante podría modificar los id. de usuario y los shells de inicio de sesión. |Establezca los permisos y la propiedad de /etc/passwd o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r set-etc-passwd-perms" |
|Los permisos de archivo /etc/group deben establecerse en 0644.<br /><sub>(12.2)</sub> |Descripción: un atacante podría elevar los privilegios mediante la modificación de la pertenencia a grupos. |Establezca los permisos y la propiedad de /etc/group o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r set-etc-group-perms". |
|Los permisos de archivo /etc/passwd- deben establecerse en 0600.<br /><sub>(12.3)</sub> |Descripción: un atacante podría unirse a grupos de seguridad si este archivo no está protegido correctamente. |Establezca los permisos y la propiedad de /etc/passwd- o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r set-etc-passwd-perms". |
|Los permisos de archivo /etc/group- deben estar establecidos en 0644.<br /><sub>(12.4)</sub> |Descripción: un atacante podría elevar los privilegios mediante la modificación de la pertenencia a grupos. |Establezca los permisos y la propiedad de /etc/group- o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r set-etc-group-perms". |
|El acceso a la cuenta raíz a través del comando su debe estar restringido al grupo "raíz".<br /><sub>(21)</sub> |Descripción: un atacante podría escalar permisos mediante la averiguación de contraseñas si el comando su no está restringido a los usuarios del grupo raíz. |Ejecute el comando "/opt/microsoft/omsagent/plugin/omsremediate -r fix-su-permissions". Esto agregará la línea "auth required pam_wheel.so use_uid" al archivo "/etc/pam.d/su". |
|El grupo "raíz" debe existir y contener todos los miembros que pueden ser su a raíz.<br /><sub>(22)</sub> |Descripción: un atacante podría escalar permisos mediante la averiguación de contraseñas si el comando su no está restringido a los usuarios del grupo raíz. |Cree el grupo raíz a través del comando "groupadd -g 0 root". |
|No hay cuentas sin contraseñas.<br /><sub>(23.2)</sub> |Descripción: un atacante puede iniciar sesión en cuentas sin contraseña y ejecutar comandos arbitrarios. |Use el comando passwd para establecer contraseñas para todas las cuentas. |
|Las cuentas que no sean raíz deben tener UID únicos mayores que cero (0).<br /><sub>(24)</sub> |Descripción: si una cuenta que no sea raíz tiene un UID cero, un atacante podría poner en peligro la cuenta y obtener privilegios de raíz. |Asigne UID únicos distintos de cero a todas las cuentas no raíz mediante "usermod-u". |
|La ubicación aleatoria de las regiones de memoria virtual debe estar habilitada.<br /><sub>(25)</sub> |Descripción: un atacante podría escribir código ejecutable en regiones conocidas en la memoria, lo que da como resultado la elevación de privilegios. |Agregue el valor "1" o "2" al archivo "/proc/sys/kernel/randomize_va_space". |
|Se debe habilitar la compatibilidad de kernel para la característica de procesador XD/NX.<br /><sub>(26)</sub> |Descripción: un atacante puede hacer que un sistema ejecute código ejecutable de regiones de datos en memoria, lo que da como resultado la elevación de privilegios. |Confirme que el archivo "/proc/cpuinfo" contiene la marca "NX". |
|El signo "." no debe aparecer en el elemento $PATH de la raíz.<br /><sub>(27.1)</sub> |Descripción: un atacante podría elevar los privilegios mediante la colocación de un archivo malintencionado en el elemento $PATH de la raíz. |Modifique la línea "export PATH=" en /root/.profile |
|Los directorios particulares de usuario deben ser de modo 750 o más restrictivos.<br /><sub>(28)</sub> |Descripción: un atacante podría recuperar información confidencial de las carpetas particulares de otros usuarios. |Establezca los permisos de la carpeta principal en 750 o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r fix-home-dir-permissions". |
|El valor predeterminado de umask para todos los usuarios debe establecerse en 077 en login.defs.<br /><sub>(29)</sub> |Descripción: un atacante podría recuperar información confidencial de archivos que pertenecen a otros usuarios. |Ejecute el comando "/opt/microsoft/omsagent/plugin/omsremediate -r set-default-user-umask". Esto agregará la línea "UMASK 077" al archivo "/etc/login.defs". |
|Todos los cargadores de arranque deben tener habilitada la protección de contraseñas.<br /><sub>(31)</sub> |Descripción: un atacante con acceso físico podría modificar las opciones del cargador de arranque y proporcionar un acceso al sistema sin restricciones. |Agregue una contraseña de cargador de arranque al archivo "/boot/grub/grub.cfg". |
|Asegurarse de que están configurados los permisos en la configuración del cargador de arranque.<br /><sub>(31.1)</sub> |Descripción: al establecer los permisos para leer y escribir en la raíz, solo se impide que los usuarios que no son raíz vean los parámetros de arranque o los cambien. Los usuarios que no son raíz y que leen los parámetros de arranque pueden identificar los puntos débiles de la seguridad en el arranque y ser capaces de aprovecharlos. |Establezca el propietario y el grupo del cargador de arranque en root:root, y los permisos en 0400, o ejecute "opt/microsoft/omsagent/plugin/omsremediate -r bootloader-permissions". |
|Asegurarse de la autenticación que se requiere para el modo de usuario único.<br /><sub>(33)</sub> |Descripción: requerir la autenticación en modo de usuario único impide que un usuario no autorizado reinicie el sistema en un solo usuario para obtener privilegios de raíz sin credenciales. |Ejecute el comando siguiente para establecer una contraseña para el usuario raíz: `passwd root`. |
|Asegurarse de que el envío de redireccionamiento de paquetes está deshabilitado.<br /><sub>(38.3)</sub> |Descripción: un atacante podría usar un host en peligro para enviar redirecciones ICMP no válidas a otros dispositivos de enrutador, en un intento de dañar el enrutamiento y que los usuarios tengan acceso a un sistema que configura el atacante en lugar de un sistema válido. |Establezca los parámetros siguientes en /etc/sysctl.conf: "net.ipv4.conf.all.send_redirects = 0" y "net.ipv4.conf.default.send_redirects = 0", o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-send-redirects". |
|Enviar redirecciones ICMP debe estar deshabilitado para todas las interfaces. (net.ipv4.conf.default.accept_redirects = 0)<br /><sub>(38.4)</sub> |Descripción: un atacante podría modificar la tabla de enrutamiento de este sistema, redirigiendo el tráfico a un destino alternativo. |Ejecute `sysctl -w key=value` y establézcalo en un valor compatible o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-accept-redirects". |
|Enviar redirecciones ICMP debe estar deshabilitado para todas las interfaces. (net.ipv4.conf.default.secure_redirects = 0)<br /><sub>(38.5)</sub> |Descripción: un atacante podría modificar la tabla de enrutamiento de este sistema, redirigiendo el tráfico a un destino alternativo. |Ejecute `sysctl -w key=value` y establézcalo en un valor compatible o ejecute "opt/microsoft/omsagent/plugin/omsremediate -r disable-secure-redirects". |
|Aceptar los paquetes enrutados de origen debe estar deshabilitada para todas las interfaces. (net.ipv4.conf.all.accept_source_route = 0)<br /><sub>(40.1)</sub> |Descripción: un atacante podría redirigir el tráfico con fines malintencionados. |Ejecute `sysctl -w key=value` y establézcalo en un valor compatible o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-accept-source-route". |
|Aceptar los paquetes enrutados de origen debe estar deshabilitada para todas las interfaces. (net.ipv6.conf.all.accept_source_route = 0) o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-accept-source-route".<br /><sub>(40.2)</sub> |Descripción: un atacante podría redirigir el tráfico con fines malintencionados. |Ejecute `sysctl -w key=value` y establézcalo en un valor compatible. |
|Omitir respuestas ICMP ficticias para las difusiones debe estar habilitado. (net.ipv4.icmp_ignore_bogus_error_responses = 1)<br /><sub>(43)</sub> |Descripción: un atacante podría realizar un ataque de ICMP que dé como resultado un ataque DoS. |Ejecute `sysctl -w key=value` y establézcalo en un valor compatible o ejecute "opt/microsoft/omsagent/plugin/omsremediate -r enable-icmp-ignore-bogus-error-responses". |
|Omitir solicitudes de eco ICMP (pings) enviadas a direcciones de difusión o multidifusión debe estar habilitado. (net.ipv4.icmp_echo_ignore_broadcasts = 1)<br /><sub>(44)</sub> |Descripción: un atacante podría realizar un ataque de ICMP que dé como resultado un ataque DoS. |Ejecute `sysctl -w key=value` y establézcalo en un valor compatible o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r enable-icmp-echo-ignore-broadcasts". |
|Registrar paquetes marcianos (los que tienen direcciones imposibles) debe estar habilitado para todas las interfaces. (net.ipv4.conf.all.log_martians = 1)<br /><sub>(45.1)</sub> |Descripción: un atacante podría enviar tráfico desde direcciones suplantadas sin ser detectado. |Ejecute `sysctl -w key=value` y establézcalo en un valor compatible o ejecute "opt/microsoft/omsagent/plugin/omsremediate -r enable-log-martians". |
|Realizar la validación de origen mediante la ruta de acceso inversa debe estar habilitada para todas las interfaces. (net.ipv4.conf.all.rp_filter = 1)<br /><sub>(46.1)</sub> |Descripción: el sistema aceptará el tráfico de las direcciones que no se pueden enrutar. |Ejecute `sysctl -w key=value` y establézcalo en un valor compatible o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r enable-rp-filter". |
|Realizar la validación de origen mediante la ruta de acceso inversa debe estar habilitada para todas las interfaces. (net.ipv4.conf.default.rp_filter = 1)<br /><sub>(46.2)</sub> |Descripción: el sistema aceptará el tráfico de las direcciones que no se pueden enrutar. |Ejecute `sysctl -w key=value` y establézcalo en un valor compatible o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r enable-rp-filter". |
|Las cookies SYN de TCP deben estar habilitadas. (net.ipv4.tcp_syncookies = 1)<br /><sub>(47)</sub> |Descripción: un atacante podría realizar un ataque DoS en TCP. |Ejecute `sysctl -w key=value` y establézcalo en un valor compatible o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r enable-tcp-syncookies". |
|El sistema no debe actuar como un analizador de protocolos de red.<br /><sub>(48)</sub> |Descripción: un atacante puede usar interfaces en modo promiscuo para rastrear el tráfico. |El modo promiscuo se habilita a través de una entrada "promisc" en "/etc/network/interfaces" o "/etc/rc.local.". Compruebe ambos archivos y quite esta entrada. |
|Todas las interfaces inalámbricas deben estar deshabilitadas.<br /><sub>(49)</sub> |Descripción: un atacante podría crear un AP falso para interceptar transmisiones. |Confirme que todas las interfaces inalámbricas están deshabilitadas en "/etc/network/interfaces". |
|El protocolo IPv6 debe estar habilitado.<br /><sub>(50)</sub> |Descripción: esto es necesario para la comunicación en redes modernas. |Abra /etc/sysctl.conf y confirme que "net.ipv6.conf.all.disable_ipv6" y "net.ipv6.conf.default.disable_ipv6" están establecidos en 0. |
|Asegurarse de que DCCP está deshabilitado<br /><sub>(54)</sub> |Descripción: si el protocolo no es necesario, se recomienda que los controladores no estén instalados para reducir la superficie de ataque potencial. |Edite o cree un archivo en el directorio `/etc/modprobe.d/` que termine en .conf y agregue `install dccp /bin/true`; después, descargue el módulo dccp o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods". |
|Asegurarse de que SCTP está deshabilitado<br /><sub>(55)</sub> |Descripción: si el protocolo no es necesario, se recomienda que los controladores no estén instalados para reducir la superficie de ataque potencial. |Edite o cree un archivo en el directorio `/etc/modprobe.d/` que termine en .conf y agregue `install sctp /bin/true`; después, descargue el módulo sctp o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods". |
|Deshabilitar la compatibilidad con RDS.<br /><sub>(56)</sub> |Descripción: un atacante podría usar una vulnerabilidad en RDS para poner en peligro el sistema. |Edite o cree un archivo en el directorio `/etc/modprobe.d/` que termine en .conf y agregue `install rds /bin/true`; después, descargue el módulo rds o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods". |
|Asegurarse de que TIPC está deshabilitado<br /><sub>(57)</sub> |Descripción: si el protocolo no es necesario, se recomienda que los controladores no estén instalados para reducir la superficie de ataque potencial. |Edite o cree un archivo en el directorio `/etc/modprobe.d/` que termine en .conf y agregue `install tipc /bin/true`; después, descargue el módulo tipc o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-unnecessary-kernel-mods". |
|Asegurarse de que el registro está configurado<br /><sub>(60)</sub> |Descripción: se envía una gran cantidad de información importante relacionada con la seguridad a través de `rsyslog` (por ejemplo, intentos correctos y erróneos de su, intentos de inicio de sesión erróneos, intentos de inicio de sesión raíz, etc.). |Configure syslog, rsyslog o syslog-ng según corresponda. |
|El paquete syslog, rsyslog o syslog-ng debe estar instalado.<br /><sub>(61)</sub> |Descripción: no se registrarán las incidencias de fiabilidad y seguridad, lo que impide un diagnóstico adecuado. |Instale el paquete rsyslog o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r install-rsyslog". |
|Asegurarse de que un servicio de registro está habilitado.<br /><sub>(62)</sub> |Descripción: es imperativo tener la capacidad de registrar eventos en un nodo. |Habilite el paquete rsyslog o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r enable-rsyslog". |
|Los permisos de archivo para todos los archivos de registro de rsyslog deben establecerse en 640 o 600.<br /><sub>(63)</sub> |Descripción: un atacante podría tapar la actividad mediante la manipulación de registros. |Agregue la línea "$FileCreateMode 0640" al archivo "/etc/rsyslog.conf". |
|Asegurarse de que los archivos de configuración del registrador están restringidos.<br /><sub>(63.1)</sub> |Descripción: es importante asegurarse de que los archivos de registro existen y tienen los permisos correctos para garantizar que los datos de syslog confidenciales se archivan y protegen. |Establezca los archivos de configuración del registrador en 0640 o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r logger-config-file-permissions". |
|Todos los archivos de registro de rsyslog deben ser propiedad del grupo adm.<br /><sub>(64)</sub> |Descripción: un atacante podría tapar la actividad mediante la manipulación de registros. |Agregue la línea "$FileGroup adm" al archivo "/etc/rsyslog.conf". |
|Todos los archivos de registro de rsyslog deben ser propiedad del usuario syslog.<br /><sub>(65)</sub> |Descripción: un atacante podría tapar la actividad mediante la manipulación de registros. |Agregue la línea "$FileOwner syslog" al archivo "/etc/rsyslog.conf" o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r syslog-owner". |
|Rsyslog no debe aceptar mensajes remotos.<br /><sub>(67)</sub> |Descripción: un atacante podría insertar mensajes en syslog, lo que provocaría un ataque DoS o una distracción de otra actividad. |Quite las líneas "$ModLoad imudp" y "$ModLoad imtcp" del archivo "/etc/rsyslog.conf". |
|El servicio logrotate (rotador de syslog) debe estar habilitado.<br /><sub>(68)</sub> |Descripción: los archivos de registro podrían crecer de forma ilimitada y consumir todo el espacio en disco. |Instale el paquete logrotate y confirme que la entrada logrotate cron está activa (chmod 755 /etc/cron.daily/logrotate; chown root:root /etc/cron.daily/logrotate). |
|El servicio rlogin debe estar deshabilitado.<br /><sub>(69)</sub> |Descripción: un atacante podría obtener acceso, omitiendo los requisitos de autenticación estrictos. |Quite el servicio inetd. |
|Deshabilitar inetd a menos que sea necesario. (inetd)<br /><sub>(70.1)</sub> |Descripción: un atacante podría aprovechar una vulnerabilidad en un servicio inetd para obtener acceso. |Desinstale el servicio inetd (apt-get remove inetd). |
|Deshabilitar xinetd a menos que sea necesario. (xinetd)<br /><sub>(70.2)</sub> |Descripción: un atacante podría aprovechar una vulnerabilidad en un servicio xinetd para obtener acceso. |Desinstale el servicio inetd (apt-get remove xinetd). |
|Instalar inetd solo si es necesario y lo requiere su distribución. Proteger según los estándares de protección actuales. (en caso necesario).<br /><sub>(71.1)</sub> |Descripción: un atacante podría aprovechar una vulnerabilidad en un servicio inetd para obtener acceso. |Desinstale el servicio inetd (apt-get remove inetd). |
|Instalar xinetd solo si es necesario y lo requiere su distribución. Proteger según los estándares de protección actuales. (en caso necesario).<br /><sub>(71.2)</sub> |Descripción: un atacante podría aprovechar una vulnerabilidad en un servicio xinetd para obtener acceso. |Desinstale el servicio inetd (apt-get remove xinetd). |
|El servicio Telnet debe estar deshabilitado.<br /><sub>(72)</sub> |Descripción: un atacante podría interceptar o secuestrar sesiones de Telnet sin cifrar. |Quite o marque como comentario la entrada de Telnet en el archivo "/etc/inetd.conf". |
|Todos los paquetes telnetd deben estar desinstalados.<br /><sub>(73)</sub> |Descripción: un atacante podría interceptar o secuestrar sesiones de Telnet sin cifrar. |Desinstale los paquetes telnetd. |
|El servicio rcp/rsh debe estar deshabilitado.<br /><sub>(74)</sub> |Descripción: un atacante podría interceptar o secuestrar sesiones no cifradas. |Quite o marque como comentario la entrada de shell en el archivo "/etc/inetd.conf". |
|El paquete rsh-server debe estar desinstalado.<br /><sub>(77)</sub> |Descripción: un atacante podría interceptar o secuestrar sesiones rsh no cifradas. |Desinstale el paquete rsh-server (apt-get remove rsh-server). |
|El servicio ypbind debe estar deshabilitado.<br /><sub>(78)</sub> |Descripción: un atacante podría recuperar información confidencial del servicio ypbind. |Desinstale el paquete nis (apt-get remove nis). |
|El paquete nis debe estar desinstalado.<br /><sub>(79)</sub> |Descripción: un atacante podría recuperar información confidencial del servicio nis. |Desinstale el paquete nis (apt-get remove nis). |
|El servicio tftp debe estar deshabilitado.<br /><sub>(80)</sub> |Descripción: un atacante podría interceptar o secuestrar una sesión no cifrada. |Quite la entrada tftp del archivo "/etc/inetd.conf". |
|El paquete tftpd debe estar desinstalado.<br /><sub>(81)</sub> |Descripción: un atacante podría interceptar o secuestrar una sesión no cifrada. |Desinstale el paquete tftpd (apt-get remove tftpd). |
|El paquete readahead-fedora debe estar desinstalado.<br /><sub>(82)</sub> |Descripción: no hay una exposición considerable, pero tampoco aporta ninguna ventaja importante. |Desinstale el paquete readahead-fedora (apt-get remove readahead-fedora). |
|El servicio bluetooth/hidd debe estar deshabilitado.<br /><sub>(84)</sub> |Descripción: un atacante podría interceptar o manipular las comunicaciones inalámbricas. |Desinstale el paquete bluetooth (apt-get remove bluetooth). |
|El servicio isdn debe estar deshabilitado.<br /><sub>(86)</sub> |Descripción: un atacante podría usar un módem para obtener acceso no autorizado. |Desinstale el paquete isdnutils-base (apt-get remove isdnutils-base). |
|El paquete isdnutils-base debe estar deshabilitado.<br /><sub>(87)</sub> |Descripción: un atacante podría usar un módem para obtener acceso no autorizado. |Desinstale el paquete isdnutils-base (apt-get remove isdnutils-base). |
|El servicio kdump debe estar deshabilitado.<br /><sub>(88)</sub> |Descripción: un atacante podría analizar un bloqueo del sistema anterior para recuperar información confidencial. |Desinstale el paquete kdump-tools (apt-get remove kdump-tools). |
|Las redes zeroconf deben estar deshabilitadas.<br /><sub>(89)</sub> |Descripción: un atacante podría usar esto para obtener información sobre los sistemas de red o las solicitudes DNS de suplantación, debido a errores en su modelo de confianza. |En el caso de RedHat, CentOS y Oracle: agregue `NOZEROCONF=yes or no` a /etc/sysconfig/network. Para el resto de distribuciones: quite todas las entradas "ipv4ll" del archivo "/etc/network/interfaces" o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-zeroconf". |
|El servicio crond debe estar habilitado.<br /><sub>(90)</sub> |Descripción: Cron es necesario para casi todos los sistemas de tareas de mantenimiento regulares. |Instale el paquete cron (apt-get install -y cron) y confirme que el archivo "/etc/init/cron.conf" contiene la línea "start on runlevel [2345]". |
|Los permisos de archivo para /etc/anacrontab deben estar establecidos en root:root 600.<br /><sub>(91)</sub> |Descripción: un atacante podría manipular este archivo para impedir tareas programadas o ejecutar tareas malintencionadas. |Establezca la propiedad y los permisos en /etc/anacrontab o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r fix-anacrontab-perms". |
|Asegurarse de que los permisos en /etc/cron.d están configurados.<br /><sub>(93)</sub> |Descripción: conceder acceso de escritura a este directorio a usuarios sin privilegios podría proporcionarles los medios para obtener privilegios elevados no autorizados. Conceder acceso de lectura a este directorio podría proporcionar a un usuario sin privilegios información sobre cómo obtener privilegios elevados o cómo eludir los controles de auditoría. |Establezca el propietario y el grupo de /etc/chron.d en raíz, y los permisos en 0700, o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r fix-cron-file-perms". |
|Asegurarse de que los permisos en /etc/cron.daily están configurados.<br /><sub>(94)</sub> |Descripción: conceder acceso de escritura a este directorio a usuarios sin privilegios podría proporcionarles los medios para obtener privilegios elevados no autorizados. Conceder acceso de lectura a este directorio podría proporcionar a un usuario sin privilegios información sobre cómo obtener privilegios elevados o cómo eludir los controles de auditoría. |Establezca el propietario y el grupo de /etc/chron.daily en raíz, y los permisos en 0700, o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r fix-cron-file-perms". |
|Asegurarse de que los permisos en /etc/cron.hourly están configurados.<br /><sub>(95)</sub> |Descripción: conceder acceso de escritura a este directorio a usuarios sin privilegios podría proporcionarles los medios para obtener privilegios elevados no autorizados. Conceder acceso de lectura a este directorio podría proporcionar a un usuario sin privilegios información sobre cómo obtener privilegios elevados o cómo eludir los controles de auditoría. |Establezca el propietario y el grupo de /etc/chron.hourly en raíz, y los permisos en 0700, o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r fix-cron-file-perms". |
|Asegurarse de que los permisos en /etc/cron.monthly están configurados.<br /><sub>(96)</sub> |Descripción: conceder acceso de escritura a este directorio a usuarios sin privilegios podría proporcionarles los medios para obtener privilegios elevados no autorizados. Conceder acceso de lectura a este directorio podría proporcionar a un usuario sin privilegios información sobre cómo obtener privilegios elevados o cómo eludir los controles de auditoría. |Establezca el propietario y el grupo de /etc/chron.monthly en raíz, y los permisos en 0700, o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r fix-cron-file-perms". |
|Asegurarse de que los permisos en /etc/cron.weekly están configurados.<br /><sub>(97)</sub> |Descripción: conceder acceso de escritura a este directorio a usuarios sin privilegios podría proporcionarles los medios para obtener privilegios elevados no autorizados. Conceder acceso de lectura a este directorio podría proporcionar a un usuario sin privilegios información sobre cómo obtener privilegios elevados o cómo eludir los controles de auditoría. |Establezca el propietario y el grupo de /etc/chron.weekly en raíz, y los permisos en 0700, o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r fix-cron-file-perms". |
|Asegurarse de que at/cron está restringido a los usuarios autorizados.<br /><sub>(98)</sub> |Descripción: en muchos sistemas, solo el administrador del sistema tiene autorización para programar trabajos `cron`. Al usar el archivo `cron.allow` para controlar quién puede ejecutar trabajos `cron`, se aplica esta directiva. Es más fácil administrar una lista de admisión que una lista de denegación. En una lista de denegación, podría agregar un id. de usuario al sistema y olvidar agregarlo a los archivos de denegación. |Reemplace /etc/cron.deny y /etc/at.deny por sus archivos `allow` respectivos. |
|Asegurarse de que el banner de advertencia de inicio de sesión remoto está configurado correctamente.<br /><sub>(111)</sub> |Descripción: los mensajes de advertencia informan a los usuarios que intentan iniciar sesión en el sistema de su estado legal en relación con el sistema, y deben incluir el nombre de la organización que posee el sistema y las directivas de supervisión que se hayan implementado. Presentar información de nivel de sistema operativo y de revisión en los banners de inicio de sesión también tiene el efecto secundario de proporcionar información detallada del sistema a los atacantes que intentan dirigirse a vulnerabilidades específicas de un sistema. Los usuarios autorizados pueden obtener esta información de forma sencilla mediante la ejecución del comando `uname -a` una vez que hayan iniciado sesión. |Quite todas las instancias de \m, \r, \s y \v del archivo /etc/issue.net. |
|Asegurarse de que el banner de advertencia de inicio de sesión local está configurado correctamente.<br /><sub>(111.1)</sub> |Descripción: los mensajes de advertencia informan a los usuarios que intentan iniciar sesión en el sistema de su estado legal en relación con el sistema, y deben incluir el nombre de la organización que posee el sistema y las directivas de supervisión que se hayan implementado. Presentar información de nivel de sistema operativo y de revisión en los banners de inicio de sesión también tiene el efecto secundario de proporcionar información detallada del sistema a los atacantes que intentan dirigirse a vulnerabilidades específicas de un sistema. Los usuarios autorizados pueden obtener esta información de forma sencilla mediante la ejecución del comando `uname -a` una vez que hayan iniciado sesión. |Quite todas las instancias de \m, \r, \s y \v del archivo /etc/issue. |
|El servicio avahi-daemon debe estar deshabilitado.<br /><sub>(114)</sub> |Descripción: un atacante podría usar una vulnerabilidad en avahi-daemon para obtener acceso. |Deshabilite el servicio avahi-daemon o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-avahi-daemon". |
|El servicio cups debe estar deshabilitado.<br /><sub>(115)</sub> |Descripción: un atacante podría usar un error en el servicio cups para elevar los privilegios. |Deshabilite el servicio cups o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-cups". |
|El servicio isc-dhcpd debe estar deshabilitado.<br /><sub>(116)</sub> |Descripción: un atacante podría usar dhcpd para proporcionar información con errores a los clientes, lo que interfiere con el funcionamiento normal. |Quite el paquete isc-dhcp-server (apt-get remove isc-dhcp-server). |
|El paquete isc-dhcp-server debe estar desinstalado.<br /><sub>(117)</sub> |Descripción: un atacante podría usar dhcpd para proporcionar información con errores a los clientes, lo que interfiere con el funcionamiento normal. |Quite el paquete isc-dhcp-server (apt-get remove isc-dhcp-server). |
|El paquete sendmail debe estar desinstalado.<br /><sub>(120)</sub> |Descripción: un atacante podría usar este sistema para enviar correos electrónicos con contenido malintencionado a otros usuarios. |Desinstale el paquete sendmail (apt-get remove sendmail). |
|El paquete postfix debe estar desinstalado.<br /><sub>(121)</sub> |Descripción: un atacante podría usar este sistema para enviar correos electrónicos con contenido malintencionado a otros usuarios. |Desinstale el paquete postfix (apt-get remove postfix) o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r remove-postfix". |
|La escucha de red postfix debe estar deshabilitada según corresponda.<br /><sub>(122)</sub> |Descripción: un atacante podría usar este sistema para enviar correos electrónicos con contenido malintencionado a otros usuarios. |Agregue la línea "inet_interfaces localhost" al archivo "/etc/postfix/main.cf". |
|El servicio ldap debe estar deshabilitado.<br /><sub>(124)</sub> |Descripción: un atacante podría manipular el servicio LDAP en este host para distribuir los datos falsos a los clientes LDAP. |Desinstale el paquete slapd (apt-get remove slapd). |
|El servicio rpcgssd debe estar deshabilitado.<br /><sub>(126)</sub> |Descripción: un atacante podría usar un error en rpcgssd/nfs para obtener acceso. |Deshabilite el servicio rpcgssd o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-rpcgssd". |
|El servicio rpcidmapd debe estar deshabilitado.<br /><sub>(127)</sub> |Descripción: un atacante podría usar un error en idmapd/nfs para obtener acceso. |Deshabilite el servicio rpcidmapd o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-rpcidmapd". |
|El servicio portmap debe estar deshabilitado.<br /><sub>(129)</sub> |Descripción: un atacante podría usar un error en portmap para obtener acceso. |Deshabilite el servicio rpcbind o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-rpcbind". |
|El servicio rpcsvcgssd debe estar deshabilitado.<br /><sub>(130)</sub> |Descripción: un atacante podría usar un error en rpcsvcgssd para obtener acceso. |Quite la línea "NEED_SVCGSSD = yes" del archivo "/etc/inetd.conf". |
|El servicio named debe estar deshabilitado.<br /><sub>(131)</sub> |Descripción: un atacante podría usar el servicio DNS para distribuir datos falsos a los clientes. |Desinstale el paquete bind9 (apt-get remove bind9). |
|El paquete bind debe estar desinstalado.<br /><sub>(132)</sub> |Descripción: un atacante podría usar el servicio DNS para distribuir datos falsos a los clientes. |Desinstale el paquete bind9 (apt-get remove bind9). |
|El servicio dovecot debe estar deshabilitado.<br /><sub>(137)</sub> |Descripción: el sistema podría usarse como un servidor IMAP/POP3. |Desinstale el paquete dovecot-core (apt-get remove dovecot-core). |
|El paquete dovecot debe estar desinstalado.<br /><sub>(138)</sub> |Descripción: el sistema podría usarse como un servidor IMAP/POP3. |Desinstale el paquete dovecot-core (apt-get remove dovecot-core). |
|Asegurarse de que no existe ninguna entrada heredada `+` en /etc/passwd.<br /><sub>(156.1)</sub> |Descripción: un atacante podría obtener acceso mediante el nombre de usuario "+" sin contraseña. |Quite todas las entradas de /etc/passwd que empiecen por "+:". |
|Asegurarse de que no existe ninguna entrada heredada `+` en /etc/shadow.<br /><sub>(156.2)</sub> |Descripción: un atacante podría obtener acceso mediante el nombre de usuario "+" sin contraseña. |Quite todas las entradas de /etc/shadow que empiecen por "+:". |
|Asegurarse de que no existe ninguna entrada heredada `+` en /etc/group.<br /><sub>(156.3)</sub> |Descripción: un atacante podría obtener acceso mediante el nombre de usuario "+" sin contraseña. |Quite todas las entradas de /etc/group que empiecen por "+:". |
|Asegurarse de que la contraseña expira en un plazo máximo de 365 días.<br /><sub>(157.1)</sub> |Descripción: la ventana de oportunidad para que un atacante pueda aprovechar las credenciales en peligro o comprometer las credenciales con éxito a través de un ataque por fuerza bruta en línea lo limita la antigüedad de la contraseña. Por lo tanto, reducir la antigüedad máxima de una contraseña también reduce la ventana de oportunidad de un atacante. |Establezca el parámetro `PASS_MAX_DAYS` en un valor que no sea superior a 365 en `/etc/login.defs` o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r  configure-password-policy-max-days". |
|Asegurarse de que los días de advertencia para la expiración de contraseña es 7 o más.<br /><sub>(157.2)</sub> |Descripción: si se proporciona una advertencia por adelantado de que una contraseña va a expirar, los usuarios tendrán tiempo para pensar en una contraseña segura. Los usuarios desprevenidos puede que elijan una contraseña sencilla o que la escriban en un lugar donde se pueda descubrir. |Establezca el parámetro `PASS_WARN_AGE` en 7 en `/etc/login.defs` o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r configure-password-policy-warn-age". |
|Asegurarse de que la reutilización de la contraseña está limitada.<br /><sub>(157.5)</sub> |Descripción: obligar a los usuarios a que no vuelvan a usar las 5 contraseñas anteriores hace que sea menos probable que un atacante pueda adivinarla. |Asegúrese de que la opción "recordar" esté establecida en al menos 5 en /etc/pam.d/common-password, o en /etc/pam.d/password_auth y /etc/pam.d/system_auth, o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r configure-password-policy-history". |
|Asegurarse de que el algoritmo de hash de contraseña es SHA-512.<br /><sub>(157.11)</sub> |Descripción: el algoritmo SHA-512 proporciona un hash mucho más seguro que MD5, lo que proporciona una protección adicional al sistema mediante el aumento del nivel de esfuerzo que necesita un atacante para determinar correctamente las contraseñas. Nota: Estos cambios solo se aplican a las cuentas configuradas en el sistema local. |Establezca el algoritmo de hash de contraseña en SHA512. Muchas distribuciones proporcionan herramientas para actualizar la configuración de PAM. Consulte la documentación para obtener más información. Si no se proporciona ninguna herramienta, edite el archivo de configuración `/etc/pam.d/` adecuado, y agregue o modifique las líneas `pam_unix.so` para incluir la opción sha512: ``` password sufficient pam_unix.so sha512 ```. |
|Asegurarse de que el número mínimo de días entre los cambios de contraseña es 7 o más.<br /><sub>(157.12)</sub> |Descripción: al restringir la frecuencia de los cambios de contraseña, un administrador puede impedir que los usuarios cambien la contraseña de forma repetida en un intento por eludir los controles de reutilización de contraseñas. |Establezca el parámetro `PASS_MIN_DAYS` en 7 en `/etc/login.defs`: `PASS_MIN_DAYS 7`. Modifique los parámetros de usuario para todos los usuarios con una contraseña establecida para que coincida: `chage --mindays 7` o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r set-pass-min-days". |
|Asegurarse de que todos los usuarios tienen la última fecha de cambio de contraseña en el pasado.<br /><sub>(157.14)</sub> |Descripción: si una fecha de cambio de contraseña registrada de los usuarios es en el futuro, podrían omitir la expiración de la contraseña establecida. |Asegúrese de que el bloqueo de contraseña inactivo es de 30 días o menos. Ejecute el comando siguiente para establecer el período predeterminado de inactividad de la contraseña en 30 días: ``` # useradd -D -f 30 ```. Modifique los parámetros de usuario para todos los usuarios con una contraseña establecida para que coincidan: ``` # chage --inactive 30  ```. |
|Asegurarse de que las cuentas del sistema no son de inicio de sesión.<br /><sub>(157.15)</sub> |Descripción: es importante asegurarse de que las cuentas que no usan los usuarios habituales no se pueden usar para proporcionar un shell interactivo. De manera predeterminada, Ubuntu establece el campo de contraseña para estas cuentas en una cadena no válida, pero también se recomienda que el campo shell del archivo de contraseña esté establecido en `/usr/sbin/nologin`. Esto impide que la cuenta se use potencialmente para ejecutar cualquier comando. |Establezca el shell para las cuentas que devuelve el script de auditoría en `/sbin/nologin`. |
|Asegurarse de que el grupo predeterminado de la cuenta raíz es GID 0.<br /><sub>(157.16)</sub> |Descripción: usar GID 0 para la cuenta `_root_ ` ayuda a impedir que los usuarios sin privilegios tengan acceso accidentalmente a los archivos de propiedad `_root_`. |Ejecute el comando siguiente para establecer el grupo predeterminado del usuario `root` en GID `0`: ``` # usermod -g 0 root ```. |
|Asegurarse de que la raíz es la única cuenta de UID 0.<br /><sub>(157.18)</sub> |Descripción: este acceso debe estar limitado solo a la cuenta `root ` predeterminada y únicamente desde la consola del sistema. El acceso administrativo debe realizarse a través de una cuenta sin privilegios mediante un mecanismo aprobado. |Quite los usuarios que no sean `root` con UID `0` o asígneles un UID nuevo, si procede. |
|Quitar paquetes innecesarios.<br /><sub>(158)</sub> |Descripción:  |Ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r remove-landscape-common". |
|Quitar cuentas innecesarias.<br /><sub>(159)</sub> |Descripción: para cumplimiento. |Quite las cuentas innecesarias. |
|Asegurarse de que el servicio auditado está habilitado.<br /><sub>(162)</sub> |Descripción: la captura de eventos del sistema proporciona a los administradores del sistema información que les permite determinar si se está produciendo acceso no autorizado a su sistema. |Instale el paquete de auditoría (systemctl enable auditd). |
|Ejecutar servicio AuditD.<br /><sub>(163)</sub> |Descripción: la captura de eventos del sistema proporciona a los administradores del sistema información que les permite determinar si se está produciendo acceso no autorizado a su sistema. |Ejecute el servicio AuditD (systemctl start auditd). |
|Asegurarse de que el servidor SNMP no está habilitado.<br /><sub>(179)</sub> |Descripción: el servidor SNMP puede comunicarse mediante SNMP v1, que transmite los datos sin cifrar y no requiere autenticación para ejecutar comandos. A menos que sea absolutamente necesario, se recomienda no usar el servicio SNMP. Si se requiere SNMP, el servidor debe configurarse para no permitir SNMP v1. |Ejecute uno de los comandos siguientes para deshabilitar `snmpd`: ``` # chkconfig snmpd off ```, ``` # systemctl disable snmpd ``` o ``` # update-rc.d snmpd disable ```. |
|Asegurarse de que el servicio rsync no está habilitado.<br /><sub>(181)</sub> |Descripción: el servicio `rsyncd` presenta un riesgo para la seguridad, ya que utiliza protocolos no cifrados para la comunicación. |Ejecute uno de los siguientes comandos para deshabilitar `rsyncd`: `chkconfig rsyncd off`, `systemctl disable rsyncd` o `update-rc.d rsyncd disable`, o ejecute "/opt/microsoft/omsagent/plugin/omsremediate -r disable-rsysnc". |
|Asegurarse de que el servidor NIS no está habilitado.<br /><sub>(182)</sub> |Descripción: el servicio NIS es, de forma intrínseca, un sistema no seguro que ha sido vulnerable a ataques DOS, al desbordamiento del búfer y que tiene una autenticación deficiente para consultar las asignaciones de NIS. Por lo general, NIS se ha reemplazado por estos protocolos como Protocolo ligero de acceso a directorios (LDAP). Se recomienda deshabilitar el servicio y usar otros servicios más seguros. |Ejecute uno de los comandos siguientes para deshabilitar `ypserv`: ``` # chkconfig ypserv off ```, ``` # systemctl disable ypserv ``` o ``` # update-rc.d ypserv disable ```. |
|Asegurarse de que el cliente rsh no está instalado.<br /><sub>(183)</sub> |Descripción: estos clientes heredados contienen numerosas exposiciones de seguridad y se han reemplazado por el paquete SSH más seguro. Incluso si se quita el servidor, es mejor asegurarse de que los clientes también se han quitado para evitar que los usuarios intenten usar estos comandos de forma inadvertida y, por tanto, exponer sus credenciales. Tenga en cuenta que, al quitar el paquete `rsh `, se quitan los clientes de `rsh`, `rcp ` y `rlogin`. |Desinstale `rsh` con el administrador de paquetes adecuado o una instalación manual: ``` yum remove rsh ```, ``` apt-get remove rsh ``` o ``` zypper remove rsh ```. |
|Deshabilitar SMB V1 con Samba.<br /><sub>(185)</sub> |Descripción: SMB v1 tiene vulnerabilidades conocidas y graves, y no cifra los datos en tránsito. Si se debe utilizar para invalidar motivos empresariales, se recomienda encarecidamente que se identifiquen otras mitigaciones para compensar el uso de este protocolo.  |Si Samba no se está ejecutando, quite el paquete; de lo contrario, debe haber una línea en la sección [global] de /etc/samba/smb.conf: min protocol = SMB2 o debe ejecutar "/opt/microsoft/omsagent/plugin/omsremediate -r set-smb-min-version". |

> [!NOTE]
> La disponibilidad de configuraciones específicas de Configuración de invitado de Azure Policy puede variar tanto en Azure Government como en otras nubes nacionales.

## <a name="next-steps"></a>Pasos siguientes

Artículos adicionales sobre Azure Policy y la Configuración de invitado:

- [Configuración de invitado de Azure Policy](../concepts/guest-configuration.md).
- Introducción al [Cumplimiento normativo](../concepts/regulatory-compliance.md).
- Consulte más ejemplos en [Ejemplos de Azure Policy](./index.md).
- Vea la [Descripción de los efectos de directivas](../concepts/effects.md).
- Obtenga información sobre cómo [corregir recursos no compatibles](../how-to/remediate-resources.md).
